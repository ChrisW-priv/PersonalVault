\documentclass[11pt]{article}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{listings}
\graphicspath{ {./} }
\setcounter{secnumdepth}{0}

\begin{document}
\begin{titlepage}
   \begin{center}
       \vspace*{1cm}
       \textbf{\Huge Numerical Methods} \\
       \vspace{2.0cm}
       \huge{ProjectAssignment A: Accuracy of computation} \\
       \vspace{.7cm}
       \huge{\today} \\
       \vspace{3.0cm}
       \vspace{0.4cm}
       Krzysztof Watras\\
       \vspace{ 0.2cm }
       \small{ Tutor's name: Jakub Wagner } \\
       \vspace{2 cm}   
       \small{Computer Science} \\  
       \vspace{0.2cm}       
       \small{Warsaw University of Technology,\\
       Faculty of Electronics and Technology} \\
       \vspace{2cm}
       \small{I declare that this piece of work, which is the basis for
       recognition of achieving learning outcomes in the Numerical Methods
       course, was completed on my own. Krzysztof Watras} \\
   \end{center}
\end{titlepage} 
\tableofcontents

\newpage
\section{Introduction}
In this report I submit results of first assignment from ENUME course. This 
assignment focuses on the errors introduced during the numerical calculation
due to inaccurate floating point representation standards. All tasks that are
to be performed involve the same equation:
$$y = \frac{\cos(x)}{x^3} - x^2$$

Task 1 is focused on calculating the error introduced by the inaccurate storage
of floating point numbers itself. This error will be noted as $\epsilon$. This
error will be different for different values of $x$, and so we will call it
$T(x)$, to make clear that this property depends on $x$. Task 2 and task 3
focus on the error introduced by inaccurate representation of intermediate
results. This error will be noted as $\eta$.  Additionally, the tasks try to
analyze, how different methods result in total error introduced to the final
result. Here we will use $K_{a1}(x)$ and $K_{a2}(x)$ to differentiate it from
error obtained in task 1 and from each other.

Throughout the document I will use following convention for two methods of
calculating the results:
\begin{itemize}
    \item \textbf{Analytical} when I am using the epsilon calculus to obtain results \\
    \item \textbf{Numerical} when I am using the method of simulation implemented as instructed in the assignment \\
\end{itemize}
This schema may be seen as slightly inaccurate, but it is consistent throughout 
the document, and it therefore considered best to avoid confusion and repetition

\section{Mathematical Symbols and formulas used}
\begin{equation}
    \sigma [\tilde{v}^k] = T^k \cdot \sigma[\tilde{v}^{k-1}] + \eta^k
    \label{eq:generaleq}
\end{equation}
\begin{equation}
    For\ \alpha \to 0,\sin(\alpha)\approx\alpha -\frac{\alpha^3}{6},\cos(\alpha)\approx 1-\frac{\alpha^2}{2}
    \label{eq:trigapprox}
\end{equation}
\begin{equation}
    \begin{align}
        (1+\epsilon_1)(1+\epsilon_2) &\approx 1 + \epsilon_1 + \epsilon_2 \\
        (1+\epsilon_1)^a &\approx 1 + a\epsilon_1 \\
    \end{align}
    \label{eq:epsilonapprox}
\end{equation}
\begin{equation}
    \begin{align}
        For\ \sigma[\tilde{y}] &\approx 
        T_1\epsilon_1 +  T_2\epsilon_2 +  T_3\epsilon_3 + \dots  \\
        & + K_1\eta_1 +  K_2\eta_2 +  K_3\eta_3 + \dots \\
        T_x &= \left|T_1\right| + \left|T_2\right| + \left|T_3\right| + \dots \\
        K_x &= \left|K_1\right| + \left|K_2\right| + \left|K_3\right| + \dots \\
    \end{align}
    \label{eq:approxerrors}
\end{equation}

Properties (\ref{eq:generaleq},\ref{eq:epsilonapprox},\ref{eq:approxerrors})
is introduced to us in the ENUME Lecture Notes[1].

Property (\ref{eq:trigapprox}) stems from the Tailor series of those functions[2].

\section{Description of the numerical methods and algorithms}
\subsection{Inline Functions}
In my calculations I use inline functions as they allow me to more easily
express the intent. This is because I do not have to create separate files and
perform linking of some sort in order to do computation. For general syntax of
Inline functions you may refer to official MATLAB documentation[3].

Inline functions I use:
\begin{lstlisting}[language=MATLAB]
    y = @(x) cos(x)./x.^3 - x.^2;
\end{lstlisting}
is just a MATLAB representation of the function we analyze in the report.
\begin{lstlisting}[language=MATLAB]
    rand_sign_vec = @() (randi(2,1,5)-1.5)*2;
\end{lstlisting}
Is a custom function that returns a matrix of size 1x5 (so a vector length 5)
of random numbers, either -1 or 1. Spread of both should be uniform as this uses
builtin function `randi` that according to documentation[4] does exactly what one
would expect it to. To clarify what is happening: first we choose number: 1 or 2,
then we shift it to -0.5 or 0.5, then we scale it to -1 or 1.

\subsection{Method of calculating the maximal error from random trials}
\begin{lstlisting}[language=MATLAB]
    tx_numerical = zeros(1, 100);
    rand_sign_vec = @() (randi(2,1,5)-1.5)*2;
    for i = 1:300
        en = eta * rand_sign_vec();
        v1 = T1 * (1+en(1));
        v2 = T1 * (1+en(2));
        v3 = T1 * (1+en(3));
        v4 = T2 * (1+en(4));
        v5 = (1+en(5));
        ytilde = v1+v2+v3+v4+v5;
        tx_numerical = max(tx_numerical, ytilde);
    end
\end{lstlisting}
This is the code that is responsible for calculations in tasks 2 (very similar in task 3). 
First, we initialize the array of 100 zeros, then we enter a loop and repeat 300 times:
\begin{enumerate}
    \item Create an array of random numbers
    \item Multiply the vector by eta
    \item Multiply each component of the answer by the $\pm$ eta
    \item Sum all components
    \item Update max error table
\end{enumerate}

\newpage
\include{Task1}

\newpage
\include{Task2}

\newpage
\include{Task3}

\newpage
\include{Task4}

\newpage
\section{References}
{[1]} R. Z. Morawski: Numerical methods (ENUME) â€“ \emph{2. Accuracy and complexity of computing}, Warsaw University of Technology, Faculty of Electronics and Information Technology \\
{[2]} Tailor Series Table and definitions: \\https://people.math.sc.edu/girardi/m142/handouts/10sTaylorPolySeries.pdf
{[3]} Mathworks, official anonymous-function documentation: \\ https://www.mathworks.com/help/matlab/matlab_prog/anonymous-functions.html \\
{[4]} Mathworks, official anonymous-function documentation: \\ https://www.mathworks.com/help/releases/R2022b/matlab/ref/randi.html?searchHighlight=randi&s_tid=doc_srchtitle \\

\newpage
\section{Appendix: Listing of the developed programs}
\subsection{Source code for Task 1}
\lstinputlisting[language=MATLAB]{sol1.m}
\newpage
\subsection{Source code for Task 2}
\lstinputlisting[language=MATLAB]{sol2.m}
\newpage
\subsection{Source code for Task 3}
\lstinputlisting[language=MATLAB]{sol3.m}
\newpage
\subsection{Source code for Task 4}
\lstinputlisting[language=MATLAB]{sol4.m}

\end{document}

